# =============================================================================
# NILM Backend - Environment Variables
# Copy to .env and fill in values
# =============================================================================

# -----------------------------------------------------------------------------
# Environment
# -----------------------------------------------------------------------------
ENV=dev                           # dev | test | prod
DEBUG=false                       # Enable debug mode

# -----------------------------------------------------------------------------
# Server
# -----------------------------------------------------------------------------
PORT=8000                         # Server port (Railway sets this automatically)
HOST=0.0.0.0                      # Server host

# -----------------------------------------------------------------------------
# CORS
# -----------------------------------------------------------------------------
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# -----------------------------------------------------------------------------
# InfluxDB
# -----------------------------------------------------------------------------
INFLUX_URL=http://localhost:8086  # InfluxDB URL (use https for production)
INFLUX_TOKEN=                     # InfluxDB admin token (REQUIRED)
INFLUX_ORG=energy-monitor         # InfluxDB organization
INFLUX_BUCKET_RAW=raw_sensor_data # Raw sensor data bucket
INFLUX_BUCKET_PRED=predictions    # Predictions bucket
INFLUX_TIMEOUT_MS=10000           # Client timeout

# -----------------------------------------------------------------------------
# Supabase
# -----------------------------------------------------------------------------
SUPABASE_URL=                     # Supabase project URL (REQUIRED)
SUPABASE_PUBLISHABLE_KEY=         # Supabase publishable/anon key (Preferred)
# SUPABASE_ANON_KEY=              # Legacy fallback
# SUPABASE_JWKS_URL=              # Optional: Auto-derived from SUPABASE_URL if empty
SUPABASE_JWT_SECRET=              # LEGACY FALLBACK: Only required if using HS256 tokens instead of JWKS

# Server-side only keys (Use ONLY if strictly required)
# SUPABASE_SECRET_KEY=            # Supabase service_role key
# SUPABASE_SERVICE_ROLE_KEY=      # Legacy fallback

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
AUTH_VERIFY_AUD=true              # Verify JWT audience claim
# TEST_JWT_SECRET=                # Test JWT secret (only used when ENV=test)

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_PER_USER=60/minute     # Rate limit per authenticated user
RATE_LIMIT_PER_IP=120/minute      # Rate limit per IP (unauthenticated)
MAX_BODY_BYTES=262144             # Max request body size (256KB)

# -----------------------------------------------------------------------------
# Admin
# -----------------------------------------------------------------------------
# ADMIN_TOKEN=                    # Admin token for protected endpoints (required in prod)

# -----------------------------------------------------------------------------
# Model Registry
# -----------------------------------------------------------------------------
MODEL_REGISTRY_PATH=/app/models/registry.json
MODELS_DIR=/app/models

# -----------------------------------------------------------------------------
# Caching
# -----------------------------------------------------------------------------
AUTHZ_CACHE_TTL_SECONDS=60        # AuthZ permission cache TTL
IDEMPOTENCY_CACHE_TTL_SECONDS=600 # Idempotency cache TTL (10 minutes)
JWKS_CACHE_TTL_HOURS=6            # JWKS cache TTL
